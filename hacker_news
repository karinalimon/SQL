--find the most popular Hacker News stories
elect title, score
 from hacker_news
 order by score desc
 limit 5;

--Is a small percentage of Hacker News submitters taking the majority of the points?
SELECT user, SUM(score)
FROM hacker_news
GROUP BY user
HAVING SUM(score) > 200
ORDER BY 2 DESC;

SELECT (517 + 309 + 304 + 282) / 6366.0;

--https://www.youtube.com/watch?v=dQw4w9WgXcQ How many times has each offending user posted this link?
SELECT user, count(*)
FROM hacker_news
where url LIKE '%watch?v=dQw4w9WgXcQ%'
group by user
order by count(*) desc;

OR

SELECT user,
   COUNT(*)
FROM hacker_news
WHERE url LIKE '%watch?v=dQw4w9WgXcQ%'
GROUP BY 1
ORDER BY 2 DESC;

--Which of these sites feed Hacker News the most: GitHub, Medium, or New York Times?
SELECT case
when url LIKE '%github.com%' then 'GitHub'
when url like '%medium.com%' then 'Medium'
when url like '%nytimes.com%' then 'New York Times'
else 'Other'
end as 'Source'
FROM hacker_news;

--Add a column for the number of stories from each URL using COUNT(). Also, GROUP BY the CASE statement.
SELECT case
when url LIKE '%github.com%' then 'GitHub'
when url like '%medium.com%' then 'Medium'
when url like '%nytimes.com%' then 'New York Times'
else 'Other'
end as 'Source', count(*)
FROM hacker_news
group by 1;

--Whatâ€™s the best time of the day to post a story on Hacker News?
SELECT
   strftime('%H', timestamp) as 'Hour', round(avg(score), 1) as avg_score, count(*) as 'Number Of Stories'
FROM hacker_news
where timestamp IS NOT NULL
group by 1
order by 2 desc;

--
