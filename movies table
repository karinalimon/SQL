--movies table
select *
from movies;

--Let’s only select the name and genre columns of the table.
SELECT name, genre 
FROM movies;

--Edit your query so that it returns the name, genre, and year columns of the table.
select name, genre, year
from movies;

--To showcase what the AS keyword does, select the name column and rename it with an alias of your choosing.
SELECT name AS 'What I Call It'
FROM movies;

--Edit the query so that instead of selecting and renaming the name column, select the imdb_rating column and rename it as IMDb
select imdb_rating as 'IMDb'
from movies;

--What are the unique genres?
SELECT DISTINCT genre 
FROM movies;

--Now, change the code so we return the unique values of the year column instead.
select distinct year
from movies;

--Suppose we want to take a peek at all the not-so-well-received movies in the database.
select *
from movies
where imdb_rating < 5;

--Now retrieve all the recent movies, specifically those that were released after 2014.
select *
from movies
where year > 2014;

--How could we select all movies that start with ‘Se’ and end with ‘en’ and have exactly one character in the middle?
SELECT * 
FROM movies
WHERE name LIKE 'Se_en';

--This one also works
SELECT * 
FROM movies
WHERE name LIKE 'Se%';

--This statement below filters the result set to only include movies with names that begin with the letter ‘A’
SELECT * 
FROM movies
WHERE name LIKE 'A%';

--We can also use % both before and after a pattern
SELECT * 
FROM movies 
WHERE name LIKE '%man%';

--Edit the query so that it selects all the information about the movie titles that begin with the word ‘The’
SELECT * 
FROM movies 
WHERE name LIKE 'The %';

--To filter for all movies with an IMDb rating
SELECT name
FROM movies 
WHERE imdb_rating IS NOT NULL;

--Write a query to find all the movies without an IMDb rating. Select only the name column.
select name
from movies
where imdb_rating IS NULL

--this statement filters the result set to only include movies with years from 1990 up to, and including 1999.
SELECT *
FROM movies
WHERE year BETWEEN 1990 AND 1999;

--In this statement, BETWEEN filters the result set to only include movies with names that begin with the letter ‘A’ up to, but not including ones that begin with ‘J’.
SELECT *
FROM movies
WHERE name BETWEEN 'A' AND 'J';

--Using the BETWEEN operator, write a query that selects all information about movies whose name begins with the letters ‘D’, ‘E’, and ‘F’.
SELECT *
FROM movies
WHERE name BETWEEN 'D' AND 'G';

--Using the BETWEEN operator, write a new query that selects all information about movies that were released from the year 1970 up to and including 1979.
SELECT *
FROM movies
where year Between 1970 AND 1979;

--use the AND operator to only return 90’s romance movies.
SELECT * 
FROM movies
WHERE year BETWEEN 1990 AND 1999
   AND genre = 'romance';

--retrieve every movie released in the 70’s, that’s also well received.
SELECT *
FROM movies
WHERE year BETWEEN 1970 AND 1979
  AND imdb_rating > 8;

--Using AND, write a new query that selects all movies made prior to 1985 that are also in the horror genre.
SELECT *
FROM movies
WHERE year < 1985 
  AND genre = 'horror';

--Suppose we want to check out a new movie or something action-packed
SELECT *
FROM movies
WHERE year > 2014
   OR genre = 'action';

--Suppose we are in the mood for a good laugh or a good cry.
SELECT *
FROM movies
WHERE genre = 'romance' or genre = 'comedy';

--sort everything by the movie’s title from A through Z
SELECT *
FROM movies
ORDER BY name;

--select all of the well-received movies, sorted from highest to lowest by their year
SELECT *
FROM movies
WHERE imdb_rating > 8
ORDER BY year DESC;

--Write a new query that retrieves the name, year, and imdb_rating columns of all the movies, ordered highest to lowest by their ratings.
SELECT name, year, imdb_rating
FROM movies
ORDER BY imdb_rating desc;

--write a query that returns the top 3 highest rated movies.
SELECT *
FROM movies
order by imdb_rating desc
LIMIT 3;

--If the rating is above 8, then it is Fantastic. If the rating is above 6, then it is Poorly Received. Else, Avoid at All Costs.
SELECT name,
 CASE
  WHEN imdb_rating > 8 THEN 'Fantastic'
  WHEN imdb_rating > 6 THEN 'Poorly Received'
  ELSE 'Avoid at All Costs'
 END
FROM movies;

--rename the column to ‘Review’
SELECT name,
 CASE
  WHEN imdb_rating > 8 THEN 'Fantastic'
  WHEN imdb_rating > 6 THEN 'Poorly Received'
  ELSE 'Avoid at All Costs'
 END AS 'Review'
FROM movies;

--Select the name column and use a CASE statement to create the second column that is:
--‘Chill’ if genre = 'romance'
--‘Chill’ if genre = 'comedy'
--‘Intense’ in all other cases
--Optional: Rename the whole CASE statement to ‘Mood’ using AS.
SELECT name,
 CASE
  WHEN genre = 'romance' THEN 'Chill'
  WHEN genre = 'comedy' THEN 'Chill'
  ELSE 'Intense'
 END AS 'Mood'
FROM movies;

