--take a look at the tables
SELECT *
FROM orders
LIMIT 5;

SELECT *
FROM subscriptions
LIMIT 5;

SELECT * 
FROM customers
LIMIT 5;

--Join orders table and subscriptions table and select all columns.
  SELECT *
FROM orders
JOIN subscriptions
  ON orders.subscription_id = subscriptions.subscription_id;

--Add a second query after your first one that only selects rows from the join where description is equal to ‘Fashion Magazine’.
SELECT *
FROM orders
JOIN subscriptions
  ON orders.subscription_id = subscriptions.subscription_id
WHERE subscriptions.description = 'Fashion Magazine';

--There is a newspaper table that contains information about the newspaper subscribers. (this is the print) Count the number of subscribers who get a print newspaper using COUNT().
  SELECT COUNT(*)
FROM newspaper;

--Count the number of subscribers who get an online newspaper using COUNT().
  select count(*)
from online;

--Join newspaper table and online table on their id columns (the unique ID of the subscriber). How many rows are in this table?
  select count(*)
from newspaper
join online
on newspaper.id = online.id;

--Suppose we want to know how many users subscribe to the print newspaper, but not to the online.
  SELECT *
FROM newspaper 
LEFT JOIN online
  ON newspaper.id = online.id;

--In order to find which users do not subscribe to the online edition, we need to add a WHERE clause.
  SELECT *
FROM newspaper 
LEFT JOIN online
  ON newspaper.id = online.id
  where online.id IS NULL;

--Suppose Columbia University has two tables in their database: The classes table contains information on the classes that the school offers. Its primary key is id. The students table contains information 
--on all students in the school. Its primary key is id. It contains the foreign key class_id, which corresponds to the primary key of classes. Perform an inner join of classes and students using the primary 
--and foreign keys described above, and select all the columns.
  select *
from classes
join students
on classes.id = students.class_id;

--counting the number of customers who were subscribed to the newspaper during March.
ELECT count(*)
from newspaper
where start_month <= 3 AND end_month >= 3;

--Select all columns from the cross join of newspaper and months.
  select *
from newspaper
cross join months;

--Create a third query where you add a WHERE statement to your cross join to restrict to two conditions: start_month <= month, end_month >= month
elect *
from newspaper
cross join months
where start_month <= month AND end_month >= month;

--select month, count(*)
from newspaper
cross join months
where start_month <= month AND end_month >= month
group by 1

--Use UNION to stack the newspaper table on top of the online table.
elect *
from newspaper
union
select *
from online;

--how many magazines each customer subscribes to. join the results of this query with our customers table, which will tell us the name of each customer
SELECT customer_id,
   COUNT(subscription_id) AS 'subscriptions'
FROM orders
GROUP BY customer_id;

--Join the temporary table previous_query with customers table and select the following columns: customers.customer_name, previous_query.subscriptions
WITH previous_query AS (
   SELECT customer_id,
   COUNT(subscription_id) AS 'subscriptions'
FROM orders
GROUP BY customer_id
)
SELECT customers.customer_name, previous_query.subscriptions
FROM previous_query
JOIN customers
  ON previous_query.customer_id = customers.customer_id;

  
